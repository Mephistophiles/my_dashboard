# Руководство по разработке

## Процесс разработки

### Обязательные требования

1. **Все новые функции разрабатываются в отдельных feature-ветках**
   - Название ветки: `feature/краткое-описание-функции`
   - Пример: `feature/add-user-authentication`

2. **Обязательное прохождение CI/CD**
   - Все изменения должны проходить все проверки в GitHub Actions
   - CI включает: форматирование, линтинг, тесты, сборку, проверку покрытия кода
   - **Покрытие кода должно быть не менее 55%** (блокирующая проверка)
   - Pull Request не может быть принят без успешного прохождения CI

3. **Проверки качества кода**
   - Код должен соответствовать стандартам форматирования Rust
   - Все предупреждения clippy должны быть исправлены
   - Все тесты должны проходить
   - Проект должен успешно собираться

### Workflow разработки

1. **Создание feature ветки**
   ```bash
   git checkout -b feature/название-функции
   ```

2. **Разработка и локальные проверки**
   ```bash
   # Запуск всех проверок локально
   just check
   
   # Или отдельные проверки
   just fmt-check
   just clippy
   just test
   just coverage-strict
   ```

3. **Коммит и пуш**
   ```bash
   git add .
   git commit -m "feat: описание изменений"
   git push origin feature/название-функции
   ```

4. **Создание Pull Request**
   - Создайте PR из feature ветки в main
   - Дождитесь прохождения всех CI проверок
   - Получите код-ревью от команды

5. **Слияние только после успешного CI**
   - PR можно мержить только при зеленом статусе всех проверок
   - При красном статусе - обязательные доработки

### Требования к покрытию кода

- **Минимальное покрытие: 55%**
- Используйте `just coverage-strict` для локальной проверки
- CI автоматически проверяет покрытие и блокирует PR при недостаточном покрытии

### Команды для разработки

```bash
# Полная проверка перед коммитом
just pre-commit

# Проверка покрытия с порогом 55%
just coverage-strict

# Все проверки качества
just check

# Форматирование кода
just fmt

# Исправление предупреждений clippy
just clippy-fix
```

### Что делать при падении CI

1. **Проверьте логи CI** - найдите причину падения
2. **Исправьте проблемы локально** - используйте соответствующие just команды
3. **Проверьте покрытие кода** - добавьте тесты если необходимо
4. **Сделайте новый коммит** и запушьте изменения
5. **Дождитесь повторного прохождения CI**

### Исключения

В редких случаях, когда покрытие кода не может быть достигнуто (например, для интеграционных тестов), обратитесь к команде для обсуждения исключения. Но это должно быть обосновано и задокументировано.

---

**Помните: Качество кода - это ответственность каждого разработчика!** 